/*!
* Open Web Excel - ✍️ An Excel Used on the Browser Side.
* git+https://github.com/hai2007/Open-Web-Excel.git
*
* author 你好2007
*
* version 0.1.0-alpha.2
*
* Copyright (c) 2021 hai2007 走一步，再走一步。
* Released under the MIT license
*
* Date:Fri Apr 23 2021 11:06:53 GMT+0800 (GMT+08:00)
*/

"use strict";function _typeof(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function e(n){return typeof n}}else{_typeof=function e(n){return n&&typeof Symbol==="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n}}return _typeof(e)}(function(){"use strict";var n=Object.prototype.toString;function t(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return n.call(e)}function o(e){if(e===null||_typeof(e)!=="object"||t(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var n=e;while(Object.getPrototypeOf(n)!==null){n=Object.getPrototypeOf(n)}return Object.getPrototypeOf(e)===n}var i=function e(n,t){return t!==null&&_typeof(t)==="object"&&n.indexOf(t.nodeType)>-1&&!o(t)};var l=function e(n){return i([1,9,11],n)};var r={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var c={stopPropagation:function e(n){n=n||window.event;if(n.stopPropagation){n.stopPropagation()}else{n.cancelBubble=true}},preventDefault:function e(n){n=n||window.event;if(n.preventDefault){n.preventDefault()}else{n.returnValue=false}},isNode:function e(n){return n&&(n.nodeType===1||n.nodeType===9||n.nodeType===11)},bind:function e(n,t,o){if(n.constructor===Array||n.constructor===NodeList||n.constructor===HTMLCollection){for(var i=0;i<n.length;i++){this.bind(n[i],t,o)}return}if(window.attachEvent)n.attachEvent("on"+t,o);else n.addEventListener(t,o,false)},unbind:function e(n,t,o){if(n.constructor===Array||n.constructor===NodeList||n.constructor===HTMLCollection){for(var i=0;i<n.length;i++){this.unbind(n[i],t,o)}return}if(window.detachEvent)n.detachEvent("on"+t,o);else n.removeEventListener(t,o,false)},find:function e(n,t,o){if(!this.isNode(n))return[];var i=n.getElementsByTagName(o||"*");var l=[];for(var r=0;r<i.length;r++){if(this.isNode(i[r])&&(typeof t!="function"||t(i[r])))l.push(i[r])}return l},children:function e(n,t){var o=n.childNodes;var i=[];for(var l=0;l<o.length;l++){if(this.isNode(o[l])&&(typeof t!="function"||t(o[l])))i.push(o[l])}return i},hasClass:function e(n,t,o){if(t.constructor!==Array)t=[t];var i=" "+(n.getAttribute("class")||"")+" ";for(var l=0;l<t.length;l++){if(i.indexOf(" "+t[l]+" ")>=0){if(o)return true}else{if(!o)return false}}return true},removeClass:function e(n,t){var o=" "+(n.getAttribute("class")||"")+" ";var i=o.replace(" "+t.trim()+" "," ");n.setAttribute("class",i.trim())},addClass:function e(n,t){if(this.hasClass(n,t))return;var o=n.getAttribute("class")||"";n.setAttribute("class",o+" "+t)},toNode:function e(n,t){var o;if(t)o=document.createElementNS(r.svg,"svg");else o=document.createElement("div");o.innerHTML=n;var i=o.childNodes;for(var l=0;l<i.length;l++){if(this.isNode(i[l]))return i[l]}},trigger:function e(n,t){if(document.createEventObject){n.fireEvent("on"+t,document.createEventObject())}else{var o=document.createEvent("HTMLEvents");o.initEvent(t,true,false);n.dispatchEvent(o)}},getStyle:function e(n,t){var o=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(n,null):n.currentStyle;return typeof t==="string"?o.getPropertyValue(t):o},offsetPosition:function e(n){var t=0;var o=0;o=n.offsetTop;t=n.offsetLeft;n=n.offsetParent;while(n){o+=n.offsetTop;t+=n.offsetLeft;n=n.offsetParent}return{left:t,top:o}},mousePosition:function e(n,t){var o=n.getBoundingClientRect();if(!t||!t.clientX)throw new Error("Event is necessary!");return{x:t.clientX-o.left,y:t.clientY-o.top}},remove:function e(n){n.parentNode.removeChild(n)},setStyles:function e(n,t){for(var o in t){n.style[o]=t[o]}},size:function e(n,t){var o,i;if(t=="content"){i=n.clientWidth-(this.getStyle(n,"padding-left")+"").replace("px","")-(this.getStyle(n,"padding-right")+"").replace("px","");o=n.clientHeight-(this.getStyle(n,"padding-top")+"").replace("px","")-(this.getStyle(n,"padding-bottom")+"").replace("px","")}else if(t=="padding"){i=n.clientWidth;o=n.clientHeight}else if(t=="border"){i=n.offsetWidth;o=n.offsetHeight}else if(t=="scroll"){i=n.scrollWidth;o=n.scrollHeight}else{i=n.offsetWidth;o=n.offsetHeight}return{width:i,height:o}},append:function e(n,t){var o=this.isNode(t)?t:this.toNode(t);n.appendChild(o);return o},prepend:function e(n,t){var o=this.isNode(t)?t:this.toNode(t);n.insertBefore(o,n.childNodes[0]);return o},after:function e(n,t){var o=this.isNode(t)?t:this.toNode(t);n.parentNode.insertBefore(o,n.nextSibling);return o},before:function e(n,t){var o=this.isNode(t)?t:this.toNode(t);n.parentNode.insertBefore(o,n);return o}};function e(){this.__el.innerHTML="";c.setStyles(this.__el,{"background-color":"#f7f7f7","user-select":"none"})}function s(e,n,t){var o=this;var i="";i+="<tr><th class='top-left' open-web-excel></th>";for(var l=0;l<e.content[0].length;l++){i+="<th class='top-name' open-web-excel>"+this.$$calcColName(l)+"</th>"}i+="</tr>";for(var r=0;r<e.content.length;r++){i+="<tr><th class='line-num' open-web-excel>"+(r+1)+"</th>";for(var s=0;s<e.content[r].length;s++){if(e.content[r][s]!="null"){i+="<th\n                  row='".concat(r+1,"'\n                  col='").concat(s+1,'\'\n                  contenteditable="true"\n                  class="item"\n                  colspan="').concat(e.content[r][s].colspan,'"\n                  rowspan="').concat(e.content[r][s].rowspan,'"\n                  style="').concat(t(e.content[r][s].style),'"\n                open-web-excel>').concat(e.content[r][s].value,"</th>")}}i+="</tr>"}this.__contentDom[n]=c.append(this.__tableFrame,"<table style='display:none;' class='excel-view' open-web-excel>"+i+"</table>");var a=c.find(this.__contentDom[n],function(e){return c.hasClass(e,"item")},"th");c.bind(a,"click",function(e){o.$$moveCursorTo(e.target,+e.target.getAttribute("row"),+e.target.getAttribute("col"))})}var a=function e(n,t){for(var o=0;o<n.__contentDom.length;o++){if(o==t){c.setStyles(n.__contentDom[o],{display:"table"});n.__btnDom[o].setAttribute("active","yes")}else{c.setStyles(n.__contentDom[o],{display:"none"});n.__btnDom[o].setAttribute("active","no")}}n.__tableIndex=t;n.$$moveCursorTo(n.__contentDom[t].getElementsByTagName("tr")[1].getElementsByTagName("th")[1],1,1)};function p(){var o=this;this.__contentDom=[];this.__tableFrame=c.append(this.__el,"<div></div>");c.setStyles(this.__tableFrame,{width:"100%",height:"calc(100% - 92px)",overflow:"auto"});for(var e=0;e<this.__contentArray.length;e++){this.$$initTableView(this.__contentArray[e],e,this.$$styleToString);c.setStyles(this.__contentDom[e],{display:e==0?"table":"none"})}this.$$addStyle("excel-view","\n\n        .excel-view{\n            border-collapse: collapse;\n            width: 100%;\n        }\n\n        .excel-view .top-left{\n            border: 1px solid #d6cccb;\n            border-right:none;\n            background-color:white;\n        }\n\n        .excel-view .top-name{\n            border: 1px solid #d6cccb;\n            border-bottom:none;\n            color:gray;\n            font-size:12px;\n        }\n\n        .excel-view .line-num{\n            padding:0 5px;\n            border: 1px solid #d6cccb;\n            border-right:none;\n            color:gray;\n            font-size:12px;\n\n        }\n\n        .excel-view .item{\n            vertical-align:top;\n            min-width:50px;\n            padding:2px;\n            white-space: nowrap;\n            border:0.5px solid rgba(85,85,85,0.5);\n            outline:none;\n            font-size:12px;\n        }\n\n        .excel-view .item[active='yes']{\n            border: 2px dashed red;\n        }\n\n    ");var i=c.append(this.__el,"<div class='bottom-btn' open-web-excel></div>");var n=c.append(i,"<span class='add item' open-web-excel>+</span>");c.bind(n,"click",function(){o.__contentArray.push(o.$$formatContent()[0]);var e=o.__contentArray.length-1;o.$$initTableView(o.__contentArray[e],e,o.$$styleToString);var n=c.append(i,"<span class='name item' open-web-excel>"+o.__contentArray[e].name+"</span>");o.__btnDom.push(n);c.bind(n,"click",function(){a(o,e)})});this.__btnDom=[];var t=function e(n){var t=c.append(i,"<span class='name item' open-web-excel>"+o.__contentArray[n].name+"</span>");c.bind(t,"click",function(){a(o,n)});c.bind(t,"dblclick",function(){o.__btnDom[n].setAttribute("contenteditable","true")});c.bind(t,"blur",function(){o.__contentArray[n].name=t.innerText});o.__btnDom.push(t)};for(var l=0;l<this.__contentArray.length;l++){t(l)}this.$$addStyle("bottom-btn","\n\n        .bottom-btn{\n            width: 100%;\n            height: 30px;\n            overflow: auto;\n            border-top: 1px solid #d6cccb;\n            box-sizing: border-box;\n        }\n\n        .bottom-btn .item{\n            line-height: 30px;\n            box-sizing: border-box;\n            vertical-align: top;\n            display: inline-block;\n            cursor: pointer;\n        }\n\n        .bottom-btn .add{\n            width: 30px;\n            text-align: center;\n            font-size: 18px;\n        }\n\n        .bottom-btn .name{\n            font-size: 12px;\n            padding: 0 10px;\n        }\n        .bottom-btn .name:focus{\n            outline:none;\n        }\n\n        .bottom-btn .name:hover{\n            background-color:#efe9e9;\n        }\n\n        .bottom-btn .name[active='yes']{\n            background-color:white;\n        }\n\n    ");this.__btnDom[0].click()}function d(e){var n="";for(var t in e){n+=t+":"+e[t]+";"}return n}function b(e){if(e&&"version"in e&&e.filename=="Open-Web-Excel"){return e.contents}else{var n=[];for(var t=0;t<100;t++){var o=[];for(var i=0;i<30;i++){o.push({value:"",colspan:"1",rowspan:"1",style:{color:"black",background:"white","text-align":"left","font-weight":"normal","font-style":"normal","text-decoration":"none"}})}n.push(o)}return[{name:"未命名",content:n}]}}function u(e){var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];var t="";while(true){var o=e%26;t=n[o]+t;e=Math.floor(e/26);if(e==0)break;e-=1}return t}var f=function e(n){var t="open-web-excel";n=n.replace(/( {0,}){/g,"{");n=n.replace(/( {0,}),/g,",");var o="";var i=false,l=false,r=false;for(var s=0;s<n.length;s++){if(n[s]==":"&&!i&&!r&&!l){r=true;o+="["+t+"]"}else if(n[s]=="{"&&!i){l=true;if(!r)o+="["+t+"]"}else if(n[s]=="}"&&!i){l=false;r=false}else if(n[s]=="/"&&n[s+1]=="*"){i=true}else if(n[s]=="*"&&n[s+1]=="/"){i=false}else if(n[s]==","&&!i&&!l){if(!r)o+="["+t+"]";r=false}o+=n[s]}return o};function g(){if("open-web-excel@style"in window);else{window["open-web-excel@style"]={}}var o=document.head||document.getElementsByTagName("head")[0];return function(e,n){if(window["open-web-excel@style"][e]);else{window["open-web-excel@style"][e]=true;var t=document.createElement("style");t.setAttribute("type","text/css");t.innerHTML=f("/*\n    Style[".concat(e,"] for Open-Web-Excel\n    https://www.npmjs.com/package/open-web-excel\n*/\n            ")+n);o.appendChild(t)}}}function v(e,n,t){if(this.__region!=null){this.$$cancelRegion();this.__region=null}if(this.__keyLog.shift){this.__region=this.$$calcRegionInfo({row:this.__rowNum,col:this.__colNum,rowNum:+this.__target.getAttribute("rowspan"),colNum:+this.__target.getAttribute("colspan")},{row:n,col:t,rowNum:+e.getAttribute("rowspan"),colNum:+e.getAttribute("colspan")});this.$$showRegion()}else{if(l(this.__target))this.__target.setAttribute("active","no");this.__rowNum=n;this.__colNum=t;this.__target=e;var o=this.__contentArray[this.__tableIndex].content[n-1][t-1];this.$$updateMenu(o.style);e.setAttribute("active","yes")}}function h(e,n){this.__contentArray[this.__tableIndex].content[this.__rowNum-1][this.__colNum-1].style[e]=n;this.__target.style[e]=n;this.$$updateMenu(this.__contentArray[this.__tableIndex].content[this.__rowNum-1][this.__colNum-1].style)}function m(e,n){var t={info:{},nodes:[]};var o=e.row;var i=e.row+e.rowNum-1;var l=n.row;var r=n.row+n.rowNum-1;var s=o>l?l:o;var a=i>r?i:r;var c=e.col;var p=e.col+e.colNum-1;var d=n.col;var b=n.col+n.colNum-1;var u=c>d?d:c;var f=p>b?p:b;t.info={row:[s,a],col:[u,f]};var g=this.__contentDom[owe.__tableIndex].getElementsByTagName("tr");for(var v=s;v<=a;v++){var h=g[v].getElementsByTagName("th");for(var m=1;m<h.length;m++){var w=h[m].getAttribute("col");if(w>=u&&w<=f){t.nodes.push(h[m])}else{if(w>f){break}}}}return t}function w(){for(var e=0;e<this.__region.nodes.length;e++){this.__region.nodes[e].style.background="#e5e0e0"}}function x(){for(var e=0;e<this.__region.nodes.length;e++){this.__region.nodes[e].style.background=this.__contentArray[this.__tableIndex].content[this.__region.nodes[e].getAttribute("row")-1][this.__region.nodes[e].getAttribute("col")-1].style.background}}var y={48:[0,")"],49:[1,"!"],50:[2,"@"],51:[3,"#"],52:[4,"$"],53:[5,"%"],54:[6,"^"],55:[7,"&"],56:[8,"*"],57:[9,"("],96:[0,0],97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,106:"*",107:"+",109:"-",110:".",111:"/",65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],37:"left",38:"up",39:"right",40:"down",33:"page up",34:"page down",35:"end",36:"home",16:"shift",17:"ctrl",18:"alt",91:"command",92:"command",93:"command",9:"tab",20:"caps lock",32:"spacebar",8:"backspace",13:"enter",27:"esc",46:"delete",45:"insert",144:"number lock",145:"scroll lock",12:"clear",19:"pause",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",189:["-","_"],187:["=","+"],219:["[","{"],221:["]","}"],220:["\\","|"],186:[";",":"],222:["'",'"'],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"]};var _=["shift","ctrl","alt"];function k(e){e=e||window.event;var n=e.keyCode||e.which;var t=y[n]||n;if(!t)return;if(t.constructor!==Array)t=[t,t];var o=t[0];var i=e.shiftKey?"shift+":"",l=e.altKey?"alt+":"",r=e.ctrlKey?"ctrl+":"";var s="",a=r+i+l;if(_.indexOf(t[0])>=0){t[0]=t[1]=""}var c=e.code=="Key"+e.key&&!i;s=a+(a==""&&c?t[1]:t[0]);if(t[0]==""){s=s.replace(/\+$/,"")}return s==""?o:s}function $(){var t=this;if("__keyLog"in this){console.error("Keyboard has been initialized");return}else{this.__keyLog={shift:false};c.bind(document.body,"keydown",function(e){var n=k(e);if(n=="shift")t.__keyLog.shift=true});c.bind(document.body,"keyup",function(e){var n=k(e);if(n=="shift")t.__keyLog.shift=false})}}function A(){return"\n    <div class='color-view' open-web-excel>\n        <div class='color-item' open-web-excel><span title='白' open-web-excel style=\"background: rgb(255, 255, 255);\"></span></div>\n        <div class='color-item' open-web-excel><span title='漆黑' open-web-excel style=\"background: rgb(13, 0, 21);\"> </span></div>\n        <div class='color-item' open-web-excel><span title=''红 open-web-excel style=\"background: rgb(254, 44, 35);\"> </span></div>\n        <div class='color-item' open-web-excel><span title=''橙 open-web-excel style=\"background: rgb(255, 153, 0);\"> </span></div>\n        <div class='color-item' open-web-excel><span title=''黄 open-web-excel style=\"background: rgb(255, 217, 0);\"> </span></div>\n        <div class='color-item' open-web-excel><span title=''葱绿 open-web-excel style=\"background: rgb(163, 224, 67);\"> </span></div>\n        <div class='color-item' open-web-excel><span title=''湖蓝 open-web-excel style=\"background: rgb(55, 217, 240);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='天色' open-web-excel style=\"background: rgb(77, 168, 238);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='藤紫' open-web-excel style=\"background: rgb(149, 111, 231);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='白练' open-web-excel style=\"background: rgb(243, 243, 244);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='白鼠' open-web-excel style=\"background: rgb(204, 204, 204);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='樱' open-web-excel style=\"background: rgb(254, 242, 240);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='镐' open-web-excel style=\"background: rgb(254, 245, 231);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='练' open-web-excel style=\"background: rgb(254, 252, 217);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='芽' open-web-excel style=\"background: rgb(237, 246, 232);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='水' open-web-excel style=\"background: rgb(230, 250, 250);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='缥' open-web-excel style=\"background: rgb(235, 244, 252);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='丁香' open-web-excel style=\"background: rgb(240, 237, 246);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='灰青' open-web-excel style=\"background: rgb(215, 216, 217);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='鼠' open-web-excel style=\"background: rgb(165, 165, 165);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='虹' open-web-excel style=\"background: rgb(251, 212, 208);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='落柿' open-web-excel style=\"background: rgb(255, 215, 185);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='花叶' open-web-excel style=\"background: rgb(249, 237, 166);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='白绿' open-web-excel style=\"background: rgb(212, 233, 214);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='天青' open-web-excel style=\"background: rgb(199, 230, 234);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='天空' open-web-excel style=\"background: rgb(204, 224, 241);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='水晶' open-web-excel style=\"background: rgb(218, 213, 233);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='薄纯' open-web-excel style=\"background: rgb(123, 127, 131);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='墨' open-web-excel style=\"background: rgb(73, 73, 73);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='甚三红' open-web-excel style=\"background: rgb(238, 121, 118);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='珊瑚' open-web-excel style=\"background: rgb(250, 165, 115);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='金' open-web-excel style=\"background: rgb(230, 179, 34);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='薄青' open-web-excel style=\"background: rgb(152, 192, 145);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='白群' open-web-excel style=\"background: rgb(121, 198, 205);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='薄花' open-web-excel style=\"background: rgb(110, 170, 215);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='紫苑' open-web-excel style=\"background: rgb(156, 142, 193);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='石墨' open-web-excel style=\"background: rgb(65, 70, 75);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='黑' open-web-excel style=\"background: rgb(51, 51, 51);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='绯红' open-web-excel style=\"background: rgb(190, 26, 29);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='棕黄' open-web-excel style=\"background: rgb(185, 85, 20);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='土黄' open-web-excel style=\"background: rgb(173, 114, 14);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='苍翠' open-web-excel style=\"background: rgb(28, 114, 49);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='孔雀' open-web-excel style=\"background: rgb(28, 120, 146);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='琉璃' open-web-excel style=\"background: rgb(25, 67, 156);\"> </span></div>\n        <div class='color-item' open-web-excel><span title='青莲' open-web-excel style=\"background: rgb(81, 27, 120);\"> </span></div>\n    </div>\n    "}function N(){var i=this;var e=c.append(this.__el,"<div class='top-dom' open-web-excel>\n\n    </div>");this.$$addStyle("top-dom","\n\n       .top-dom{\n            width: 100%;\n            height: 62px;\n            overflow: auto;\n       }\n\n    ");this.__menuDom=c.append(e,"<div class='menu' open-web-excel>\n        <span open-web-excel>\n            操作\n            <div open-web-excel>\n                <span class='item more' open-web-excel>\n                    合并单元格\n                    <div open-web-excel>\n                        <span class='item' def-type='merge-all' open-web-excel>全部合并</span>\n                    </div>\n                </span>\n            </div>\n        </span>\n        <span open-web-excel>\n            格式\n            <div open-web-excel>\n                <span class='item' def-type='bold' open-web-excel>粗体</span>\n                <span class='item' def-type='italic' open-web-excel>斜体</span>\n                <span class='item' def-type='underline' open-web-excel>下划线</span>\n                <span class='item' def-type='line-through' open-web-excel>中划线</span>\n                <span class='line' open-web-excel></span>\n                <span class='item more' open-web-excel>\n                    水平对齐\n                    <div open-web-excel>\n                        <span class='item' def-type='horizontal-left' open-web-excel>左对齐</span>\n                        <span class='item' def-type='horizontal-center' open-web-excel>居中对齐</span>\n                        <span class='item' def-type='horizontal-right' open-web-excel>右对齐</span>\n                    </div>\n                </span>\n            </div>\n        </span>\n        <span open-web-excel>\n            帮助\n            <div open-web-excel>\n                <span class='item' open-web-excel>\n                    <a href='https://github.com/hai2007/Open-Web-Excel/issues' open-web-excel target='_blank'>问题反馈</a>\n                </span>\n            </div>\n        </span>\n    </div>");this.$$addStyle("menu",'\n\n        .menu{\n            border-bottom: 1px solid #d6cccb;\n            padding: 0 20px;\n            box-sizing: border-box;\n        }\n\n        .menu>span{\n            display: inline-block;\n            line-height: 26px;\n            padding: 0 10px;\n            font-size: 12px;\n            cursor: pointer;\n            color: #555555;\n        }\n        .menu>span:hover{\n            background: white;\n        }\n\n        .menu>span>div{\n            margin-left: -10px;\n        }\n\n        .menu>span div{\n            position:absolute;\n            background: white;\n            width: 140px;\n            box-shadow: 4px 3px 6px 0 #c9c9e2;\n            display:none;\n            padding:5px 0;\n        }\n\n        .menu>span div span{\n            display:block;\n            position:relative;\n            padding:5px 20px;\n        }\n\n        .menu>span div span>div{\n            left:140px;\n            top:0px;\n        }\n\n        .menu .line{\n            height:1px;\n            background-color:#d6cccb;\n            padding:0;\n            margin:0 10px;\n        }\n\n        .menu span:hover>div{\n            display:block;\n        }\n\n        .menu span.more:after{\n            content:">";\n            position: absolute;\n            right: 12px;\n            font-weight: 800;\n        }\n\n        .menu a{\n            text-decoration: none;\n            color: #555555;\n        }\n\n        .menu input{\n            width:20px;\n            outline:none;\n        }\n\n        .menu .item.active::before{\n            content: "*";\n            color: red;\n            position: absolute;\n            left: 8px;\n        }\n\n        .menu .item{\n            text-decoration: none;\n        }\n\n        .menu .item:hover{\n            text-decoration: underline;\n        }\n\n    ');this.__menuQuickDom=c.append(e,"<div class='quick-menu' open-web-excel>\n        <span class='item' def-type='format' open-web-excel>格式刷</span>\n        <span class='line' open-web-excel></span>\n        <span class='item color' def-type='font-color' open-web-excel>\n            文字颜色：<i class='color' open-web-excel></i>\n            ".concat(A(),"\n        </span>\n        <span class='item color' def-type='background-color' open-web-excel>\n            填充色：<i class='color' open-web-excel></i>\n            ").concat(A(),"\n        </span>\n        <span class='line' open-web-excel></span>\n        <span class='item' def-type='merge-all' open-web-excel>\n            全部合并\n        </span>\n        <span class='line' open-web-excel></span>\n        <span class='item' def-type='horizontal-left' open-web-excel>\n            左对齐\n        </span>\n        <span class='item' def-type='horizontal-center' open-web-excel>\n            居中对齐\n        </span>\n        <span class='item' def-type='horizontal-right' open-web-excel>\n            右对齐\n        </span>\n    </div>"));this.$$addStyle("quick-menu","\n\n        .quick-menu{\n            line-height: 36px;\n            font-size: 12px;\n        }\n\n        .quick-menu span{\n            display:inline-block;\n            vertical-align: top;\n        }\n\n        .quick-menu span>i.color{\n            display: inline-block;\n            height: 14px;\n            width: 20px;\n            border:1px solid #d6cccb;\n            vertical-align: middle;\n        }\n\n        .quick-menu .item{\n            margin:0 10px;\n            cursor: pointer;\n        }\n\n        .quick-menu .line{\n            background-color:#d6cccb;\n            width:1px;\n            height:22px;\n            margin-top:7px;\n        }\n\n        .quick-menu .item:hover{\n            font-weight: 800;\n        }\n\n        .quick-menu .item.active{\n            font-weight: 800;\n            color: red;\n        }\n\n        /* 选择颜色 */\n\n        .color-view{\n            font-size: 0px;\n            width: 171px;\n            position: absolute;\n            padding: 10px;\n            box-sizing: content-box;\n            background: #fefefe;\n            box-shadow: 1px 1px 5px #9e9695;\n            line-height:1em;\n            display:none;\n        }\n\n        .color:hover>.color-view{\n            display:block;\n        }\n\n        .color-item{\n            display: inline-block;\n            width: 19px;\n            height: 19px;\n        }\n\n        .color-item>span{\n            width: 15px;\n            height: 15px;\n            margin: 2px;\n            cursor: pointer;\n            box-sizing: border-box;\n        }\n\n        .color-item>span:hover{\n            outline:1px solid black;\n        }\n\n    ");var n=c.find(e,function(e){return e.getAttribute("def-type")},"span");c.bind(n,"click",function(e){var n=e.target;var t=n.getAttribute("def-type");if(t=="format");else if(t=="font-color");else if(t=="background-color");else if(t=="bold"){i.$$setItemStyle("font-weight",c.hasClass(n,"active")?"normal":"bold")}else if(t=="italic"){i.$$setItemStyle("font-style",c.hasClass(n,"active")?"normal":"italic")}else if(t=="line-through"){i.$$setItemStyle("text-decoration",c.hasClass(n,"active")?"none":"line-through")}else if(t=="underline"){i.$$setItemStyle("text-decoration",c.hasClass(n,"active")?"none":"underline")}else if(/^horizontal\-/.test(t)){i.$$setItemStyle("text-align",t.replace("horizontal-",""))}else if(/^merge\-/.test(t)){if(i.__region==null)return;if(t=="merge-all"){if(i.__region.nodes.length<=1)return;for(var o=1;o<i.__region.nodes.length;o++){i.__contentArray[i.__tableIndex].content[i.__region.nodes[o].getAttribute("row")-1][i.__region.nodes[o].getAttribute("col")-1]="null";i.__region.nodes[o].remove()}i.__region.nodes=[i.__region.nodes[0]];i.__contentArray[i.__tableIndex].content[i.__region.nodes[0].getAttribute("row")-1][i.__region.nodes[0].getAttribute("col")-1].colspan=i.__region.info.col[1]-i.__region.info.col[0]+1+"";i.__contentArray[i.__tableIndex].content[i.__region.nodes[0].getAttribute("row")-1][i.__region.nodes[0].getAttribute("col")-1].rowspan=i.__region.info.row[1]-i.__region.info.row[0]+1+"";i.__region.nodes[0].setAttribute("colspan",i.__region.info.col[1]-i.__region.info.col[0]+1+"");i.__region.nodes[0].setAttribute("rowspan",i.__region.info.row[1]-i.__region.info.row[0]+1+"");i.$$cancelRegion();i.__region=null}}})}function C(e){var n=c.find(this.__menuDom,function(e){return e.getAttribute("def-type")},"span");for(var t=0;t<n.length;t++){var o=n[t].getAttribute("def-type");if(o=="bold"){if(e["font-weight"]=="bold"){c.addClass(n[t],"active")}else{c.removeClass(n[t],"active")}}else if(o=="italic"){if(e["font-style"]=="italic"){c.addClass(n[t],"active")}else{c.removeClass(n[t],"active")}}else if(o=="underline"){if(e["text-decoration"]=="underline"){c.addClass(n[t],"active")}else{c.removeClass(n[t],"active")}}else if(o=="line-through"){if(e["text-decoration"]=="line-through"){c.addClass(n[t],"active")}else{c.removeClass(n[t],"active")}}else if(/^horizontal\-/.test(o)){if(o=="horizontal-"+e["text-align"]){c.addClass(n[t],"active")}else{c.removeClass(n[t],"active")}}}var i=c.find(this.__menuQuickDom,function(e){return e.getAttribute("def-type")},"span");for(var l=0;l<i.length;l++){var r=i[l].getAttribute("def-type");if(r=="font-color"){i[l].getElementsByTagName("i")[0].style.backgroundColor=e.color}else if(r=="background-color"){i[l].getElementsByTagName("i")[0].style.backgroundColor=e.background}else if(/^horizontal\-/.test(r)){if(r=="horizontal-"+e["text-align"]){c.addClass(i[l],"active")}else{c.removeClass(i[l],"active")}}}}var S=function e(n){var t=this;if(!(this instanceof e)){throw new Error("Open-Web-Excel is a constructor and should be called with the `new` keyword")}if(l(n.el)){this.__el=n.el;this.__contentArray=this.$$formatContent(n.content);this.__region=null}else{throw new Error("options.el is not a element!")}this.$$renderKeyboard();this.$$initDom();this.$$createdMenu();this.$$initView();this.valueOf=function(){return{version:"0.1.0",filename:"Open-Web-Excel",contents:t.__contentArray}}};S.prototype.$$formatContent=b;S.prototype.$$calcColName=u;S.prototype.$$addStyle=g();S.prototype.$$styleToString=d;S.prototype.$$initDom=e;S.prototype.$$initView=p;S.prototype.$$initTableView=s;S.prototype.$$createdMenu=N;S.prototype.$$updateMenu=C;S.prototype.$$moveCursorTo=v;S.prototype.$$setItemStyle=h;S.prototype.$$calcRegionInfo=m;S.prototype.$$showRegion=w;S.prototype.$$cancelRegion=x;S.prototype.$$renderKeyboard=$;if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=S}else{window.OpenWebExcel=S}})();