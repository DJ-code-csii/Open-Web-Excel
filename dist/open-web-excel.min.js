/*!
* Open Web Excel - ✍️ An Excel Used on the Browser Side.
* git+https://github.com/hai2007/Open-Web-Excel.git
*
* author 你好2007
*
* version 0.1.0-alpha.0
*
* Copyright (c) 2021 hai2007 走一步，再走一步。
* Released under the MIT license
*
* Date:Fri Apr 16 2021 17:31:01 GMT+0800 (GMT+08:00)
*/

"use strict";function _typeof(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function t(e){return typeof e}}else{_typeof=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(t)}(function(){"use strict";var e=Object.prototype.toString;function n(t){if(t==null){return t===undefined?"[object Undefined]":"[object Null]"}return e.call(t)}function o(t){if(t===null||_typeof(t)!=="object"||n(t)!="[object Object]"){return false}if(Object.getPrototypeOf(t)===null){return true}var e=t;while(Object.getPrototypeOf(e)!==null){e=Object.getPrototypeOf(e)}return Object.getPrototypeOf(t)===e}var r=function t(e,n){return n!==null&&_typeof(n)==="object"&&e.indexOf(n.nodeType)>-1&&!o(n)};var i=function t(e){return r([1,9,11],e)};var s={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var l={stopPropagation:function t(e){e=e||window.event;if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},preventDefault:function t(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},isNode:function t(e){return e&&(e.nodeType===1||e.nodeType===9||e.nodeType===11)},bind:function t(e,n,o){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var r=0;r<e.length;r++){this.bind(e[r],n,o)}return}if(window.attachEvent)e.attachEvent("on"+n,o);else e.addEventListener(n,o,false)},unbind:function t(e,n,o){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var r=0;r<e.length;r++){this.unbind(e[r],n,o)}return}if(window.detachEvent)e.detachEvent("on"+n,o);else e.removeEventListener(n,o,false)},find:function t(e,n,o){if(!this.isNode(e))return[];var r=e.getElementsByTagName(o||"*");var i=[];for(var s=0;s<r.length;s++){if(this.isNode(r[s])&&(typeof n!="function"||n(r[s])))i.push(r[s])}return i},children:function t(e,n){var o=e.childNodes;var r=[];for(var i=0;i<o.length;i++){if(this.isNode(o[i])&&(typeof n!="function"||n(o[i])))r.push(o[i])}return r},hasClass:function t(e,n,o){if(n.constructor!==Array)n=[n];var r=" "+(e.getAttribute("class")||"")+" ";for(var i=0;i<n.length;i++){if(r.indexOf(" "+n[i]+" ")>=0){if(o)return true}else{if(!o)return false}}return true},removeClass:function t(e,n){var o=" "+(e.getAttribute("class")||"")+" ";var r=o.replace(" "+n.trim()+" "," ");e.setAttribute("class",r.trim())},addClass:function t(e,n){if(this.hasClass(e,n))return;var o=e.getAttribute("class")||"";e.setAttribute("class",o+" "+n)},toNode:function t(e,n){var o;if(n)o=document.createElementNS(s.svg,"svg");else o=document.createElement("div");o.innerHTML=e;var r=o.childNodes;for(var i=0;i<r.length;i++){if(this.isNode(r[i]))return r[i]}},trigger:function t(e,n){if(document.createEventObject){e.fireEvent("on"+n,document.createEventObject())}else{var o=document.createEvent("HTMLEvents");o.initEvent(n,true,false);e.dispatchEvent(o)}},getStyle:function t(e,n){var o=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return typeof n==="string"?o.getPropertyValue(n):o},offsetPosition:function t(e){var n=0;var o=0;o=e.offsetTop;n=e.offsetLeft;e=e.offsetParent;while(e){o+=e.offsetTop;n+=e.offsetLeft;e=e.offsetParent}return{left:n,top:o}},mousePosition:function t(e,n){var o=e.getBoundingClientRect();if(!n||!n.clientX)throw new Error("Event is necessary!");return{x:n.clientX-o.left,y:n.clientY-o.top}},remove:function t(e){e.parentNode.removeChild(e)},setStyles:function t(e,n){for(var o in n){e.style[o]=n[o]}},size:function t(e,n){var o,r;if(n=="content"){r=e.clientWidth-(this.getStyle(e,"padding-left")+"").replace("px","")-(this.getStyle(e,"padding-right")+"").replace("px","");o=e.clientHeight-(this.getStyle(e,"padding-top")+"").replace("px","")-(this.getStyle(e,"padding-bottom")+"").replace("px","")}else if(n=="padding"){r=e.clientWidth;o=e.clientHeight}else if(n=="border"){r=e.offsetWidth;o=e.offsetHeight}else if(n=="scroll"){r=e.scrollWidth;o=e.scrollHeight}else{r=e.offsetWidth;o=e.offsetHeight}return{width:r,height:o}},append:function t(e,n){var o=this.isNode(n)?n:this.toNode(n);e.appendChild(o);return o},prepend:function t(e,n){var o=this.isNode(n)?n:this.toNode(n);e.insertBefore(o,e.childNodes[0]);return o},after:function t(e,n){var o=this.isNode(n)?n:this.toNode(n);e.parentNode.insertBefore(o,e.nextSibling);return o},before:function t(e,n){var o=this.isNode(n)?n:this.toNode(n);e.parentNode.insertBefore(o,e);return o}};function t(){this._el.innerHTML="";l.setStyles(this._el,{"background-color":"#f7f7f7"})}function c(){var t="";t+="<tr><th style='width:50px;border: 1px solid #d6cccb;border-right:none;background-color:white;'></th>";for(var e=0;e<this._contentArray[0].length;e++){t+="<th style='border: 1px solid #d6cccb;border-bottom:none;color:gray;'>"+this.$$calcColName(e)+"</th>"}t+="</tr>";for(var n=0;n<this._contentArray.length;n++){t+="<tr><th style='width:50px;border: 1px solid #d6cccb;border-right:none;color:gray;'>"+(n+1)+"</th>";for(var o=0;o<this._contentArray[n].length;o++){if(this._contentArray[n][o]!="null"){t+='<th style="border:1px solid #000000;background-color:white;" index="'+n+"-"+o+'" row-number="'+n+'" col-number="'+o+'" colspan="'+this._contentArray[n][o].colspan+'"  rowspan="'+this._contentArray[n][o].rowspan+'">'+this._contentArray[n][o].content+"</th>"}}t+="</tr>"}this._contentDom=l.append(this._el,"<table>"+t+"</table>");l.setStyles(this._contentDom,{"border-collapse":"collapse",width:"100%"})}function f(t){return t}function a(t){return["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"][t]}var u=function t(e){var n=this;if(!(this instanceof t)){throw new Error("Open-Web-Excel is a constructor and should be called with the `new` keyword")}if(i(e.el)){this._el=e.el;this._contentArray=this.$$formatContent(e.content)}else{throw new Error("options.el is not a element!")}this.$$initDom();this.$$initView();this.valueOf=function(){return n._contentArray}};u.prototype.$$formatContent=f;u.prototype.$$calcColName=a;u.prototype.$$initDom=t;u.prototype.$$initView=c;if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=u}else{window.OpenWebExcel=u}})();